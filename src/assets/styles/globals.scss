@tailwind base;
@tailwind components;
@tailwind utilities;

@layer demo;

@layer demo {
  [aria-hidden] li, .nav li {
    aspect-ratio: 1;
    border-radius: 50%;
    display: grid;
    place-items: center;
    width: 32px;
  }

  :root {
    --bg: color-mix(in hsl, canvas 8%, canvasText);
    --color: color-mix(in hsl, canvas 92%, canvasText);
  }

  .nav button {
    padding: 0;
    width: 100%;
  }

  .nav {
    background: linear-gradient(var(--bg), var(--bg)) padding-box,
    linear-gradient(white, black) border-box;
    border: 1px solid transparent;
    bottom: 3rem;
    border-radius: 100px;
    box-shadow: 0 4px 8px 0 hsl(0 0% 0% / 0.2);
    color: var(--color);
    left: 50%;
    padding: 0 32px;
    position: fixed;
    transition: opacity 0s var(--transition);
    translate: -50% 0;
  }

  body:has(:popover-open) .nav {
    opacity: 0;
    transition-delay: 0s;
  }

  [popover] [aria-hidden] :where(a),
  .nav :where(a, button) {
    aspect-ratio: 1;
    background: transparent;
    border: 0;
    border-radius: 50%;
    color: inherit;
    cursor: pointer;
    display: grid;
    place-items: center;
    width: 100%;

    &:is(:focus-visible) {
      background: color-mix(in hsl, canvas, canvasText 75%);
      outline-color: transparent;
      outline-width: 0px;
    }
  }

  [popover] [aria-hidden],
  .nav ul {
    display: flex;
    flex-direction: row;
    height: 60px;
    justify-content: space-between;
    width: 300px;
  }

  [popover] [aria-hidden] {
    position: absolute;
    bottom: 4px;
    left: 50%;
    translate: -50% 0;
  }

  .nav {
    anchor-name: --nav;
  }

  [popover] .content__content {
    height: min(var(--height), 80vh);
    left: 0;
    padding: 4px;
    top: 0;
    width: min(var(--width), 100vw - 2rem);
  }

  [popover] {
    background: linear-gradient(var(--bg), var(--bg)) padding-box,
      linear-gradient(white, black) border-box;
    border: 1px solid transparent;
    color: var(--color);
    inset: unset;
    position-anchor: --nav;
  }

  :root {
    --ease: linear(
      0 0%,
      0.0027 3.64%,
      0.0106 7.29%,
      0.0425 14.58%,
      0.0957 21.87%,
      0.1701 29.16%,
      0.2477 35.19%,
      0.3401 41.23%,
      0.5982 55.18%,
      0.7044 61.56%,
      0.7987 68.28%,
      0.875 75%,
      0.9297 81.25%,
      0.9687 87.5%,
      0.9922 93.75%,
      1 100%
    );
    --height: 580px;
    --power-in: linear(
      0 0%,
      0.0039 6.25%,
      0.0156 12.5%,
      0.0352 18.75%,
      0.0625 25%,
      0.0977 31.25%,
      0.1407 37.5%,
      0.1914 43.74%,
      0.2499 49.99%,
      0.3164 56.25%,
      0.3906 62.5%,
      0.5625 75%,
      0.7656 87.5%,
      1 100%
    );
    --power-in-out: linear(
      0 0%,
      0.0012 14.95%,
      0.0089 22.36%,
      0.0297 28.43%,
      0.0668 33.43%,
      0.0979 36.08%,
      0.1363 38.55%,
      0.2373 43.07%,
      0.3675 47.01%,
      0.5984 52.15%,
      0.7121 55.23%,
      0.8192 59.21%,
      0.898 63.62%,
      0.9297 66.23%,
      0.9546 69.06%,
      0.9733 72.17%,
      0.9864 75.67%,
      0.9982 83.73%,
      1 100%
    );
    --power-out: linear(
      0 0%,
      0.2342 12.49%,
      0.4374 24.99%,
      0.6093 37.49%,
      0.6835 43.74%,
      0.7499 49.99%,
      0.8086 56.25%,
      0.8593 62.5%,
      0.9023 68.75%,
      0.9375 75%,
      0.9648 81.25%,
      0.9844 87.5%,
      0.9961 93.75%,
      1 100%
    );
    --transition: calc(var(--speed, 0.35) * 1s);
    --width: 640px;
  }

  [popover] {
    border-radius: 21px;
    box-shadow: 0 4px 8px 0 hsl(0 0% 0% / 0.2);
    bottom: anchor(bottom);
    height: anchor-size(height);
    left: anchor(left);
    padding: 0;
    transition-behavior: allow-discrete;
    transition-duration: var(--transition);
    transition-property: display, overlay, width, height, border-radius;
    transition-timing-function: var(--ease);
    translate: -50% 0;
    width: anchor-size(width);

    @starting-style {
      height: min(var(--height), 80vh);
      width: min(var(--width), 100vw - 2rem);
    }
  }

  .content {
    inset: 0;
    overflow: hidden;
    position: absolute;
  }

  [popover]:popover-open {
    border-radius: 21px;
    height: min(var(--height), 80vh);
    width: min(var(--width), 100vw - 2rem);

    @starting-style {
      border-radius: 21px;
      height: anchor-size(height);
      width: anchor-size(width);
    }
  }

  [popover] [aria-hidden] li {
    --delay: calc(sin((var(--i) / 6) * 45deg) * (var(--speed) * 1));
    --speed: calc(var(--transition) * 0.7);
    transition-delay: var(--delay);
    transition-duration: var(--speed);
    transition-property: opacity, translate, filter;
  }

  [popover]:popover-open [aria-hidden] li {
    filter: blur(4px);
    opacity: 0;
    translate: 0 100%;

    @starting-style {
      filter: blur(0);
      opacity: 1;
      translate: 0 0;
    }
  }
}
